# Run this workflow once to generate package-lock.json, then commit the result.
# After that, you can delete this workflow file.
name: Generate package-lock.json

on:
  workflow_dispatch:

jobs:
  generate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "20"
          cache: "npm"

      - name: Generate lock file
        run: npm install

      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v6
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          commit-message: "chore: add package-lock.json"
          branch: add-package-lock
          delete-branch: true
          title: "Add package-lock.json"
          body: |
            Auto-generated package-lock.json for reproducible installs.
            Merge this PR to add the lock file. After merging, you can delete `.github/workflows/generate-lockfile.yml`.
